---
description: "資訊安全規範 - 全面的安全性要求和防護措施"
type: "Auto Attached"
pattern: "**/*.{js,ts,jsx,tsx,py,go,java,cpp,c,rs,php,rb,kt,sql,yaml,yml,json,env}"
version: "2.0.1"
author: "資訊安全委員會"
last_updated: "2025-06-16T11:22:50+08:00"
enforcement_level: "critical"
compliance_frameworks: ["OWASP", "ISO-27001", "SOC-2"]
---

# 資訊安全規範

本規範建立了comprehensive的資訊安全標準，涵蓋程式碼安全、資料保護、存取控制和合規要求，以確保系統安全性和資料隱私保護。

## 安全程式設計原則

### 安全預設設定

所有系統組件必須採用安全預設配置，包含最小權限原則、預設拒絕政策、安全失敗機制。新功能的安全設定必須採用最嚴格的配置，後續根據實際需求適度放寬。

API端點預設為需要認證，資料庫連接預設啟用加密，檔案上傳預設限制檔案類型和大小。所有外部通信必須使用HTTPS/TLS 1.3協議。

### 縱深防禦策略

實施多層次的安全防護機制，包含輸入驗證、輸出編碼、存取控制、資料加密、活動監控。單一防護層的失效不應導致整體安全性的完全破壞。

每個安全層都必須獨立運作，具備獨立的監控和警報機制。安全控制措施必須覆蓋開發、測試、預生產和生產環境。

## 輸入驗證與資料淨化

### 輸入驗證機制

所有外部輸入必須經過嚴格的驗證和淨化處理，採用白名單驗證策略。驗證範圍包含資料類型、格式、長度、範圍、字符集合。特殊字符必須進行適當的轉義或拒絕處理。

實施伺服器端驗證為主、客戶端驗證為輔的策略。客戶端驗證僅用於用戶體驗改善，不可作為安全控制的依據。所有驗證失敗都必須記錄並監控異常模式。

### SQL注入防護

所有資料庫操作必須使用參數化查詢或預處理語句，嚴禁使用字符串拼接構建SQL查詢。ORM框架的使用必須正確配置，避免動態查詢的安全風險。

資料庫連接必須使用最小權限帳號，避免使用具備DDL權限的帳號進行應用程式操作。實施資料庫查詢監控，檢測異常查詢模式和潛在攻擊行為。

### XSS攻擊防護

所有用戶輸入在輸出到HTML頁面前必須進行適當的編碼處理，包含HTML實體編碼、JavaScript編碼、CSS編碼、URL編碼。使用成熟的模板引擎和自動轉義機制。

實施Content Security Policy (CSP)標頭，限制JavaScript執行來源和內聯腳本。定期進行XSS漏洞掃描和滲透測試，確保防護措施的有效性。

## 認證與授權機制

### 身份認證要求

實施強密碼政策，包含密碼長度（最少12字符）、複雜度要求（包含大小寫字母、數字、特殊字符）、密碼歷史（不得重複使用最近12個密碼）、密碼有效期（最長90天）。

支援多因素認證（MFA），關鍵系統和管理功能必須強制啟用MFA。使用業界標準的認證協議，如OAuth 2.1、OpenID Connect、SAML 2.0。密碼儲存必須使用強哈希演算法（bcrypt、scrypt、Argon2）。

### 授權控制實作

實施基於角色的存取控制（RBAC）或屬性為基礎的存取控制（ABAC），確保用戶只能存取其工作職責所需的資源。授權決策必須在伺服器端進行，客戶端的授權檢查僅用於UI優化。

API端點必須實施細粒度的權限控制，包含操作級別（讀取、創建、更新、刪除）和資源級別（特定資料記錄）的權限檢查。實施最小權限原則，定期檢視和調整使用者權限。

### 會話管理安全

會話令牌必須使用加密強度的隨機數生成，令牌長度不少於128位元。會話必須設定適當的超時時間，閒置超時不超過30分鐘，絕對超時不超過8小時。

會話令牌必須透過安全的HTTP Cookie傳輸，設定HttpOnly、Secure、SameSite屬性。會話終止時必須清除所有相關的會話數據，包含伺服器端和客戶端儲存。

## 資料保護與加密

### 敏感資料識別

建立敏感資料分類標準，包含個人身份資訊（PII）、財務資訊、健康資訊、商業機密。所有敏感資料必須標記並實施相應的保護措施。

敏感資料的收集必須遵循最小化原則，只收集業務必需的資料。資料保留期限必須明確定義，過期資料必須安全銷毀。實施資料遮罩和假名化技術，減少敏感資料暴露風險。

### 加密實作標準

所有敏感資料必須在傳輸和儲存時進行加密保護。傳輸加密使用TLS 1.3協議，儲存加密使用AES-256演算法。加密金鑰必須與資料分離儲存，實施金鑰輪換機制。

資料庫敏感欄位必須進行欄位級加密，使用經過驗證的加密函式庫。避免自行實作加密演算法，使用業界標準的加密解決方案。實施適當的金鑰管理系統（KMS）。

### 資料備份安全

資料備份必須加密儲存，備份資料的存取權限必須嚴格控制。備份儲存位置必須與生產環境物理隔離，實施異地備份策略。

定期測試資料恢復程序，確保備份資料的完整性和可用性。備份媒體的銷毀必須遵循安全標準，確保資料無法恢復。實施備份資料的版本控制和審計日誌。

## 安全監控與事件回應

### 安全日誌記錄

所有安全相關事件必須記錄，包含認證嘗試（成功和失敗）、授權決策、敏感資料存取、配置變更、系統異常。日誌必須包含時間戳、用戶身份、操作描述、結果狀態、來源IP。

日誌資料必須保護免於未授權修改，使用日誌完整性檢查機制。日誌儲存必須符合法規要求，typically保留至少一年。實施日誌分析和異常檢測，自動識別潛在安全威脅。

### 入侵檢測與防護

部署網路入侵檢測系統（NIDS）和主機入侵檢測系統（HIDS），監控異常活動和攻擊行為。實施自動化回應機制，包含IP封鎖、帳號鎖定、管理員通知。

定期進行漏洞掃描和滲透測試，識別系統弱點並及時修復。建立安全事件回應計劃，明確事件分類、回應流程、責任分工、溝通機制。

### 威脅情報整合

整合外部威脅情報來源，及時獲取最新的安全威脅資訊。建立威脅指標（IoC）庫，自動檢測已知的惡意活動。實施威脅狩獵活動，主動尋找潛在的安全威脅。

建立安全態勢感知平台，整合多種安全工具的資料，提供統一的安全監控視圖。實施安全指標（KSI）監控，包含攻擊檢測率、誤報率、回應時間。

## 第三方安全管理

### 依賴性安全掃描

所有第三方函式庫和組件必須進行安全掃描，檢測已知漏洞。使用自動化工具定期檢查依賴性更新，及時修復安全漏洞。建立依賴性清單，追蹤所有外部組件的安全狀態。

實施依賴性許可證檢查，確保符合組織的許可證政策。避免使用不再維護或有嚴重安全問題的第三方組件。建立供應鏈安全檢查程序。

### API安全標準

外部API呼叫必須實施適當的認證和授權機制，使用API金鑰、OAuth 2.1或類似標準。API金鑰必須定期輪換，實施API呼叫頻率限制，防止濫用。

API回應必須進行資料驗證，防止惡意回應導致的安全問題。實施API監控，檢測異常呼叫模式和潛在攻擊。建立API安全測試程序，包含模糊測試和邊界測試。

## 合規性要求

### 法規遵循

確保系統設計和實作符合適用的法規要求，包含GDPR、CCPA、HIPAA、PCI DSS等。實施資料主體權利保護，包含資料可攜性、刪除權、更正權。建立隱私影響評估程序。

實施資料處理活動記錄，包含資料類型、處理目的、法律依據、保留期限。建立資料保護官（DPO）制度，負責隱私合規監督。定期進行合規性審計和評估。

### 安全認證要求

配合組織的安全認證要求，包含ISO 27001、SOC 2、FedRAMP等。提供必要的安全控制證據和文檔，支援外部審計活動。實施持續合規監控，確保控制措施的有效性。

建立安全控制自我評估程序，定期檢視控制措施的實施狀況。建立矯正行動追蹤機制，確保發現的問題得到及時解決。

---

本安全規範的遵循情況將透過自動化安全掃描、人工安全評估和定期安全審計進行監控。所有安全要求都是強制性的，違反將導致嚴重的合規後果。
